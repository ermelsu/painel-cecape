<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<title>Painel CECAPE</title>
<style>
    body {
        background: #112162;
        color: white;
        font-family: "Segoe UI", sans-serif;
        margin: 0;
    }
    h1 {
        text-align: center;
        padding: 20px;
        color: #e9a44d;
        font-size: 40px;
    }
    table {
        width: 95%;
        margin: auto;
        border-collapse: collapse;
        font-size: 22px;
    }
    th {
        background: #0963b3;
        padding: 14px;
        text-transform: uppercase;
    }
    td {
        background: #7092c4;
        padding: 10px;
        border-bottom: 2px solid #112162;
        font-weight: 600;
        text-align: center;
    }

    /* Flipboard animation */
    .flip {
        display: inline-block;
        animation: flipAnim 0.6s ease-in-out;
    }
    @keyframes flipAnim {
        0% { transform: rotateX(90deg); opacity: 0; }
        100% { transform: rotateX(0); opacity: 1; }
    }

    /* STATUS COLORS */
    .ANDAMENTO {
        background: #f4d03f !important;
        color: #000 !important;
        font-weight: 900;
    }
    .OCUPADA { background: #f48407 !important; }
    .LIVRE { background: #2ecc71 !important; }
    .EVENTO { background: #0963b3 !important; }
    .MANUTENCAO, .MANUTENÇÃO { background: #c0392b !important; }
</style>
</head>

<body>
<h1>Painel de Salas - CECAPE</h1>

<table id="tabela">
    <thead>
        <tr>
            <th>Sala</th>
            <th>Bloco</th>
            <th>Andar</th>
            <th>Professor</th>
            <th>Horário</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT5TbQshXscY_CKSXWmdtX7gfpYHOyDqKuDgReqcHQjpkWP6EotfNxp9sL-KQnrrQSTGevOhfVU1RnM/gviz/tq?tqx=out:json";

async function carregarTabela() {
    const resposta = await fetch(URL);
    let texto = await resposta.text();

    // Remove o lixo do Google: "/*O_o*/" e "google.visualization.Query.setResponse("
    texto = texto
        .replace("/*O_o*/", "")
        .replace("google.visualization.Query.setResponse(", "")
        .replace(/\);$/, "");

    const json = JSON.parse(texto);
    const linhas = json.table.rows;

    const tbody = document.querySelector("#tabela tbody");
    tbody.innerHTML = "";

    linhas.forEach(linha => {
        const c = linha.c;
        if (!c || c.length < 6) return;

        const tr = document.createElement("tr");

        c.forEach((col, i) => {
            const td = document.createElement("td");
            const span = document.createElement("span");

            const valor = col ? col.v : "";

            span.classList.add("flip");
            span.textContent = valor;

            td.appendChild(span);

            // STATUS
            if (i === 5) {
                const classe = valor.toUpperCase().normalize("NFD").replace(/[\u0]()
